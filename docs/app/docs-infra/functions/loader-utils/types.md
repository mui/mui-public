# Loader Utils

[//]: types.ts '<-- Autogenerated By (do not edit the following markdown directly)'

## API Reference

### parseImportsAndComments

Parse import statements from JavaScript/TypeScript/CSS code.

This function analyzes source code to extract all import statements, categorizing them
as either relative imports (local files) or external imports (packages). It supports
JavaScript, TypeScript, CSS, and MDX files.

Comment processing (stripping/collecting) is performed during import parsing
for efficiency. Since we must already parse the entire file character-by-character
to correctly identify imports while avoiding false positives in strings, comments,
and template literals, it's most efficient to handle comment processing in this
same pass rather than requiring separate parsing steps.

### ImportName

Represents a single import name with its properties.

### ImportPathPosition

Represents the position of an import path in the source code.

### RelativeImport

Represents an import from a relative path (starts with ./ or ../).

### ExternalImport

Represents an import from an external package (node_modules).

### ImportsAndComments

The result of parsing import statements from source code.

### isJavaScriptModule

Checks if a file path or import path represents a JavaScript/TypeScript module

### resolveModulePath

Resolves a module path by reading directory contents to find matching files.
This is more efficient than checking each file individually with stat calls.

Given a path like `/Code/mui-public/packages/docs-infra/docs/app/components/code-highlighter/demos/code/BasicCode`,
this function will try to find the actual file by checking for:

- `BasicCode.ts`, `BasicCode.tsx`, `BasicCode.js`, `BasicCode.jsx`
- `BasicCode/index.ts`, `BasicCode/index.tsx`, `BasicCode/index.js`, `BasicCode/index.jsx`

### resolveModulePaths

Resolves multiple module paths efficiently by grouping them by directory
and performing batch directory lookups.

### resolveImportResult

Resolves import result by separating JavaScript modules from static assets,
only resolving JavaScript modules and returning a combined map.
This function uses the new type-aware resolveModulePath function internally.

### resolveVariantPaths

Resolves variant paths from a variants object mapping variant names to their file paths.
This function extracts the paths, resolves them using resolveModulePaths, and returns
a map from variant name to resolved file URL.

### JAVASCRIPT_MODULE_EXTENSIONS

Default file extensions for JavaScript/TypeScript modules that can be resolved

### TYPE_IMPORT_EXTENSIONS

Extension priority for type-only imports - prioritize .d.ts first

### VALUE_IMPORT_EXTENSIONS

Extension priority for value imports - standard priority with .d.ts last

### DirectoryEntry

### ResolveModulePathOptions

### TypeAwareResolveResult

### rewriteImports

Efficiently rewrites import paths using position data.
This avoids regex parsing and uses precise position information for replacement.
Works for both JavaScript/TypeScript and CSS imports.

### processRelativeImports

Processes imports based on the specified storage mode, automatically handling
source rewriting when needed (e.g., for 'flat' mode). Works for both JavaScript and simple file types.

### ProcessImportsResult

### getFileNameFromUrl

Extracts the filename and extension from a URL or file path.
This function is isomorphic and works in both Node.js and browser environments.
It properly handles compound extensions like .module.css, .d.ts, .test.js, etc.

### extractNameAndSlugFromUrl

Extracts and formats a name and slug from a URL path

### externalsToPackages

```typescript
  code: string,
  filePath: string,
  options:
    | {
        removeCommentsWithPrefix?: string[]
        notableCommentsPrefix?: string[]
      }
    | undefined,
) => Promise<ImportsAndComments>
```

```typescript
type ImportName = {
  name: string;
  alias?: string;
  type: 'default' | 'named' | 'namespace';
  isType?: boolean;
};
```

```typescript
type ImportPathPosition = { start: number; end: number };
```

```typescript
type RelativeImport = {
  path: string;
  names: {
    name: string;
    alias?: string;
    type: 'default' | 'named' | 'namespace';
    isType?: boolean;
  }[];
  includeTypeDefs?: true;
  positions: { start: number; end: number }[];
};
```

```typescript
type ExternalImport = {
  names: {
    name: string;
    alias?: string;
    type: 'default' | 'named' | 'namespace';
    isType?: boolean;
  }[];
  positions: { start: number; end: number }[];
};
```

```typescript
type ImportsAndComments = {
  relative: Record<string, RelativeImport>;
  externals: Record<string, ExternalImport>;
  code?: string;
  comments?: Record<number, string[]>;
};
```

```typescript
(path: string) => boolean;
```

```typescript
  modulePath: string,
  readDirectory: (
    path: string,
  ) => Promise<DirectoryEntry[]>,
  options: { extensions?: string[] } | undefined,
  includeTypeDefs: boolean | undefined,
) => Promise<string | TypeAwareResolveResult>
```

```typescript
  modulePaths: string[],
  readDirectory: (
    path: string,
  ) => Promise<DirectoryEntry[]>,
  options: { extensions?: string[] } | undefined,
) => Promise<Map<string, string>>
```

```typescript
  importResult: Record<
    string,
    {
      path: string
      names: string[]
      includeTypeDefs?: true
      positions?: { start: number; end: number }[]
    }
  >,
  readDirectory: (
    path: string,
  ) => Promise<DirectoryEntry[]>,
  options: { extensions?: string[] } | undefined,
) => Promise<Map<string, string>>
```

```typescript
  variants: Record<string, string>,
  readDirectory: (
    path: string,
  ) => Promise<DirectoryEntry[]>,
  options: { extensions?: string[] } | undefined,
) => Promise<Map<string, string>>
```

```typescript
['.ts', '.tsx', '.js', '.jsx', '.mdx', '.d.ts'];
```

```typescript
['.d.ts', '.ts', '.tsx', '.js', '.jsx', '.mdx'];
```

```typescript
['.ts', '.tsx', '.js', '.jsx', '.mdx', '.d.ts'];
```

```typescript
type DirectoryEntry = {
  name: string;
  isFile: boolean;
  isDirectory: boolean;
};
```

```typescript
type ResolveModulePathOptions = { extensions?: string[] };
```

```typescript
type TypeAwareResolveResult = {
  import: string;
  typeImport?: string;
};
```

```typescript
  source: string,
  importPathMapping: Map<string, string>,
  importResult: Record<
    string,
    { positions: { start: number; end: number }[] }
  >,
) => string
```

```typescript
  source: string,
  importResult: Record<
    string,
    {
      path: string
      names: string[]
      positions?: { start: number; end: number }[]
    }
  >,
  storeAt: StoreAtMode,
  isJsFile: boolean | undefined,
  resolvedPathsMap: Map<string, string> | undefined,
) => {
  processedSource: string
  extraFiles: Record<string, string>
}
```

```typescript
type ProcessImportsResult = {
  processedSource: string;
  extraFiles: Record<string, string>;
};
```

```typescript
  fileName: string
  extension: string
}
```

```typescript
(url: string) => {
  name: string;
  slug: string;
};
```

```typescript
(externals: string[]) => Record<string, true>;
```
