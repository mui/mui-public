{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "description": "Renovate configuration for MUI repositories.",
  "extends": [
    "github>mui/mui-public//renovate/base",
    ":semanticCommitsDisabled",
    "group:definitelyTyped",
    "config:recommended",
    "helpers:pinGitHubActionDigests",
    "npm:unpublishSafe"
  ],
  "automerge": false,
  "commitMessageAction": "Bump",
  "commitMessageExtra": "to {{newValue}}",
  "commitMessageTopic": "{{depName}}",
  "dependencyDashboard": true,
  "rebaseWhen": "conflicted",
  "labels": ["dependencies"],
  "lockFileMaintenance": {
    "enabled": true
  },
  "postUpdateOptions": ["pnpmDedupe"],
  "prConcurrentLimit": 30,
  "prHourlyLimit": 0,
  "rangeStrategy": "bump",
  "timezone": "UTC",
  "internalChecksFilter": "strict",
  "ignorePresets": [":ignoreModulesAndTests"],
  "ignorePaths": ["**/node_modules/**", "**/examples/**", "**/__tests__/**", "**/__fixtures__/**"],
  "customManagers": [
    {
      "description": "Custom manager for MUI public repository digests",
      "customType": "regex",
      "fileMatch": ["(^|\\/)?\\.circleci\\/.+\\.ya?ml$"],
      "matchStrings": [
        // For circleci config files
        "https:\\\/\\\/raw\\.githubusercontent\\.com\\\/mui\\\/mui-public\\\/(?<currentDigest>.*?)\\\/.+"
      ],
      "currentValueTemplate": "master",
      "depNameTemplate": "code-infra-orb",
      "packageNameTemplate": "https://github.com/mui/mui-public",
      "datasourceTemplate": "git-refs"
    },
    {
      "description": "Custom manager for Playwright Docker image versions",
      "customType": "regex",
      "fileMatch": ["(^|\\\/)\\.circleci\\\/.+\\.ya?ml$"],
      "matchStrings": [
        // For Playwright Docker image versions
        "playwright-img-version:\\s*'?(?<currentValue>[^'\\s]+)'?"
      ],
      "depNameTemplate": "code-infra-playwright",
      "packageNameTemplate": "mcr.microsoft.com/playwright",
      "datasourceTemplate": "docker"
    }
  ],
  "vulnerabilityAlerts": {
    "addLabels": ["security"]
  },
  "packageRules": [
    {
      "matchDepTypes": ["peerDependencies"],
      "rangeStrategy": "widen"
    },
    {
      "groupName": "MUI public packages",
      "matchPackageNames": ["@mui/*", "!@mui/internal-*", "!@mui/docs"]
    },
    {
      "groupName": "MUI infra packages",
      "matchPackageNames": ["@mui/internal-*", "@mui/docs", "https://github.com/mui/mui-public"],
      "schedule": null,
      "reviewers": ["mui/infra"],
      "minimumReleaseAge": null
    },
    {
      "matchSourceUrls": ["https://github.com/mui/mui-public"],
      "matchDatasources": ["npm"],
      "followTag": "canary"
    },
    {
      "groupName": "GitHub Actions",
      "matchManagers": ["github-actions"]
    },
    {
      "matchDepTypes": ["action"],
      "matchCurrentVersion": "!/^0/",
      "matchUpdateTypes": ["minor", "patch", "digest"]
    },
    {
      "groupName": "@definitelytyped tools",
      "matchPackageNames": ["@definitelytyped/*"]
    },
    {
      "groupName": "node",
      "description": "Restricts Node.js version bumps in Github Actions workflows.",
      "extends": ["group:nodeJs"],
      "allowedVersions": "<=22.18"
    },
    {
      "groupName": "node",
      "matchDepTypes": ["uses-with"],
      "matchDepNames": ["node"],
      "allowedVersions": "<=22.18"
    },
    {
      "groupName": "node",
      "matchPackageNames": ["@types/node"],
      "allowedVersions": "<=22.18"
    },
    {
      "matchDepTypes": ["engines"],
      "matchFileNames": ["packages/*/package.json"],
      "enabled": false
    },
    {
      "groupName": "eslint",
      "extends": ["monorepo:eslint", "monorepo:typescript-eslint"]
    },
    {
      "groupName": "eslint",
      "matchPackageNames": [
        "eslint-plugin-*",
        "*/eslint-plugin-*",
        // Should stay with the Next.js group
        "!@next/eslint-plugin-next"
      ]
    },
    {
      "groupName": "eslint",
      "matchSourceUrls": ["https://github.com/eslint/*"]
    },
    {
      "groupName": "playwright monorepo",
      "description": "Extends existing playwright preset to include docker images. See https://github.com/renovatebot/renovate/discussions/23889",
      "matchPackageNames": ["mcr.microsoft.com/playwright"]
    },
    {
      "groupName": "Vite & Vitest",
      "extends": ["packages:vite"]
    },
    {
      "groupName": "Vite & Vitest",
      "extends": ["monorepo:vitest"]
    },
    {
      "groupName": "Vite & Vitest",
      "matchPackageNames": ["esbuild", "vitest-browser-react"]
    },
    {
      "matchPackageNames": ["eslint-config-prettier"],
      "allowedVersions": ">=10.1.8"
    },
    {
      // until https://github.com/mui/mui-public/pull/927 is solved
      "groupName": "Quarantine",
      "matchPackageNames": ["@mui/internal-test-utils"],
      "enabled": false
    }
  ]
}
